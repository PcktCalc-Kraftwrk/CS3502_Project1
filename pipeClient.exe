using System;
using System.IO;
using System.IO.Pipes;

class PipeClient
{
static void Main(static[] args)
{
if(args.Length > 0)
{
using(PipeStream pipeClient = new AnonymousPipeClientStream(PipeDirection.In, args[0]))
{
Console.WriteLine("[CLIENT] Current TransmissionMode: {0}.", pipeClient.TransmissionMode);

using(StreamReader sr = new StreamReader(pipeClient))
{
string temp;
do
{
Console.WriteLine("[CLIENT] Wait for sync...");
temp = sr.ReadLine();
}
while (!temp.StartsWith("SYNC"));

while((temp = sr.ReadLine()) != null)
{
Console.WriteLine("[CLIENT] Echo: " + temp);
}
}
}
}
Console.Write("[CLIENT] Press Enter to continue...");
Console.ReadLine();
}
}